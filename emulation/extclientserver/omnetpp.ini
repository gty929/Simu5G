[General]
scheduler-class = "inet::RealTimeScheduler"
cmdenv-express-mode = true
image-path=../../../images
output-scalar-file-append = false
sim-time-limit = 60s
network = simu5g.emulation.extclientserver.ExtClientServerExample

**.routingRecorder.enabled = false
**.networkConfiguratorModule = ""
**.fcsMode = "computed"
**.crcMode = "computed"

############### Statistics ##################
output-scalar-file = ${resultdir}/${configname}/${repetition}.sca
output-vector-file = ${resultdir}/${configname}/${repetition}.vec
seed-set = ${repetition}

################ Mobility parameters #####################
# *

**.mobility.constraintAreaMaxX = 1000m
**.mobility.constraintAreaMaxY = 1000m
**.mobility.constraintAreaMinX = 0m
**.mobility.constraintAreaMinY = 0m
**.mobility.constraintAreaMinZ = 0m
**.mobility.constraintAreaMaxZ = 0m
**.mobility.initFromDisplayString = false

############### Phy layer parameters ################
**.amcType = "NRAmc"
**.pilotMode = "ROBUST_CQI" 
**.targetBler = 0.01
**.blerShift = 5  
**.fbPeriod = 40 

############### IPv4 configurator config #################
*.configurator.config = xmldoc("./demo.xml")

############### eNodeB configuration #################
*.gnb1.mobility.initialX = 300m
*.gnb1.mobility.initialY = 500m
*.gnb2.mobility.initialX = 700m
*.gnb2.mobility.initialY = 500m

*.gnb1.gateway = "upf_A"
*.gnb2.gateway = "upf_B"

*.router.gateway = "upf_A"
*.router2.gateway = "upf_B"

############## ue configuration ##################
# connect the ue's NIC to the corresponding serving gnb
*.ue*.macCellId = 0
*.ue*.masterId = 0
*.ue*.nrMacCellId = 1
*.ue*.nrMasterId = 1
# **.dynamicCellAssociation = true
**.enableHandover = true

# ue position
*.ue*.mobility.typename = "LinearMobility"
*.ue*.mobility.initialX = 450m
*.ue*.mobility.initialY = 500m
*.ue*.mobility.speed = 10mps
*.ue*.mobility.initialMovementHeading = 0deg

############### CA configuration ######################## 
*.carrierAggregation.numComponentCarriers = 1
*.carrierAggregation.componentCarrier[0].numerologyIndex = 0
*.carrierAggregation.componentCarrier[0].carrierFrequency = 2GHz
*.carrierAggregation.componentCarrier[0].numBands = 10

*.gnb1.cellularNic.numCarriers = 1
*.gnb1.cellularNic.channelModel[0].componentCarrierIndex = 0
*.gnb2.cellularNic.numCarriers = 1
*.gnb2.cellularNic.channelModel[0].componentCarrierIndex = 0
*.ue.cellularNic.numNRCarriers = 1
*.ue.cellularNic.nrChannelModel[0].componentCarrierIndex = 0

#*.gnb*.cellularNic.phy.enableHandover = true
#*.gnb*.cellularNic.phy.handoverLatency = 50ms
#*.gnb*.cellInfo.broadcastMessageInterval = 1s # eNB will sends broadcast triggers every second
# X2 and SCTP configuration
# *.gnb*.numX2Apps = 1    # one x2App per peering eNodeB
#*.gnb*.x2App[*].server.localPort = 5000 + ancestorIndex(1) # Server ports (x2App[0]=5000, x2App[1]=5001, ...)
# *.gnb1.x2App[0].client.connectAddress = "gnb2%x2ppp0" 
# *.gnb2.x2App[0].client.connectAddress = "gnb1%x2ppp0" 
#**.sctp.nagleEnabled = false         # if true, transmission of small packets will be delayed on the X2
#**.sctp.enableHeartbeats = false

#
# This configuration uses sockets to exchange packets with the real world 
#
[Config ExtClientServer]

############## Routing configuration ##############
# configure routing tables of each network element. Each of them must include a route to the (real) client 
*.router.ipv4.routingTable.routingFile = "routing/router.mrt"
*.upf_A.ipv4.routingTable.routingFile = "routing/upf.mrt"
*.upf_B.ipv4.routingTable.routingFile = "routing/upf.mrt"
*.gnb1.ipv4.routingTable.routingFile = "routing/gnb1.mrt"
*.ue.ipv4.routingTable.routingFile = "routing/ue.mrt"

*.router2.ipv4.routingTable.routingFile = "routing/router.mrt"
*.gnb2.ipv4.routingTable.routingFile = "routing/gnb1.mrt"

############## Ext Interface configuration ##############
# equip the router with an External Ethernet interface 
*.router.numEthInterfaces = 1
*.router.eth[0].typename = "ExtLowerEthernetInterface"
*.router.eth[0].device = "simveth-nginx1"
*.router2.numEthInterfaces = 1
*.router2.eth[0].typename = "ExtLowerEthernetInterface"
*.router2.eth[0].device = "simveth-nginx2"

*.ue.numEthInterfaces = 1
*.ue.eth[0].typename = "ExtLowerEthernetInterface"
*.ue.eth[0].device = "simveth-client1"
*.ue.extHostAddress = "192.168.3.100"
*.ue.ipv4.forwarding = true

